@if (loading()) {
<div class="flex justify-center items-center p-8">
  <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
</div>
} @else if (favorites().length === 0) {
<div class="text-center p-8 text-gray-500">
  <div class="text-4xl mb-2 text-gray-300">‚ù§Ô∏è</div>
  <h3 class="text-lg font-medium mb-2">No favorites yet</h3>
  <p>Start adding movies to your favorites!</p>
</div>
} @else {
<div class="flex justify-between items-center mb-4">
  <h2 class="text-xl font-semibold">Your Favorites ({{ favorites().length }})</h2>
  <button
    (click)="onExportFavorites()"
    class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"
  >
    üì• Export
  </button>
</div>

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
  @for (movie of favorites(); track movie.id) {
  <div
    class="cursor-pointer border rounded-lg overflow-hidden hover:shadow-lg transition-shadow h-full flex flex-col bg-white"
    (click)="onSelectMovie(movie.id)"
  >
    <div class="relative">
      <img
        [src]="getImageSource(movie)"
        [alt]="movie.title"
        class="w-full h-48 object-cover"
        (error)="onImageError($event, movie)"
      />

      <button
        (click)="onRemoveFavorite(movie.id, $event)"
        class="absolute top-2 right-2 p-2 text-red-500 hover:text-red-700 transition-colors z-10"
        title="Remove from favorites"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="currentColor"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
          />
        </svg>
      </button>
    </div>

    <div class="p-4 flex-grow">
      <h3 class="font-medium line-clamp-2 text-gray-900">{{ movie.title }}</h3>
      <p class="text-sm text-gray-600 mt-1">{{ movie.year }}</p>
      <p class="text-xs text-gray-500 mt-2">Added: {{ movie.addedAt | date : 'mediumDate' }}</p>
    </div>
  </div>
  }
</div>
}
