import{Da as M,Ea as a,Ib as y,Jb as k,Ta as I,Zb as F,aa as D,ab as L,bb as s,cb as c,ec as A,fa as _,ga as C,ha as E,ia as f,jb as t,kb as o,lb as u,mb as S,nb as T,oa as h,pb as v,qb as p,tb as N,vb as n,wb as d,xb as g}from"./chunk-Z46XBT6O.js";function V(l,i){l&1&&(t(0,"div",13),u(1,"div",16),t(2,"p",17),n(3,"Loading movie details..."),o()())}function j(l,i){if(l&1&&(t(0,"span",35),n(1),o()),l&2){let e=p(3);a(),g(" Box Office: ",e.movie().boxOffice," ")}}function O(l,i){if(l&1&&(t(0,"span",36),n(1),o()),l&2){let e=p(3);a(),g(" Production: ",e.movie().production," ")}}function U(l,i){if(l&1&&(t(0,"span",37),n(1),o()),l&2){let e=p(3);a(),g(" Awards: ",e.movie().awards," ")}}function B(l,i){if(l&1&&(t(0,"div",34),s(1,j,2,1,"span",35),s(2,O,2,1,"span",36),s(3,U,2,1,"span",37),o()),l&2){let e=p(2);a(),c(e.movie().boxOffice?1:-1),a(),c(e.movie().production?2:-1),a(),c(e.movie().awards?3:-1)}}function R(l,i){if(l&1){let e=S();t(0,"div",14)(1,"div",18)(2,"div",19)(3,"img",20),v("error",function(m){_(e);let x=p();return C(x.onImageError(m))}),o()(),t(4,"div",21)(5,"h1",22),n(6),o(),t(7,"div",23)(8,"span",24),n(9),o(),t(10,"span"),n(11),o(),t(12,"span",25),n(13),o()(),t(14,"p",26),n(15),o()()(),t(16,"div",27)(17,"div",28)(18,"div",29)(19,"span",30),n(20,"Director:"),o(),t(21,"span",31),n(22),o()(),t(23,"div",29)(24,"span",30),n(25,"Actors:"),o(),t(26,"span",31),n(27),o()(),t(28,"div",29)(29,"span",30),n(30,"Writer:"),o(),t(31,"span",31),n(32),o()(),t(33,"div",29)(34,"span",30),n(35,"Language:"),o(),t(36,"span",31),n(37),o()(),t(38,"div",29)(39,"span",30),n(40,"Country:"),o(),t(41,"span",31),n(42),o()(),t(43,"div",29)(44,"span",30),n(45,"Released:"),o(),t(46,"span",31),n(47),o()()(),t(48,"div")(49,"h3",32),n(50,"Plot"),o(),t(51,"p",33),n(52),o()(),s(53,B,4,3,"div",34),o()()}if(l&2){let e=p();a(3),T("src",e.getImageSource(),M)("alt",e.movie().title),a(3),d(e.movie().title),a(3),d(e.movie().year),a(2),d(e.movie().runtime||"N/A"),a(2),g(" \u2B50 ",e.movie().imdbRating||"N/A"," "),a(2),d(e.movie().genre||"Genre not specified"),a(7),d(e.movie().director||"N/A"),a(5),d(e.movie().actors||"N/A"),a(5),d(e.movie().writer||"N/A"),a(5),d(e.movie().language||"N/A"),a(5),d(e.movie().country||"N/A"),a(5),d(e.movie().released||"N/A"),a(5),d(e.movie().plot||"Plot not available."),a(),c(e.movie().boxOffice||e.movie().production||e.movie().awards?53:-1)}}function z(l,i){if(l&1){let e=S();t(0,"div",15)(1,"div",38),n(2,"\u274C"),o(),t(3,"h3",39),n(4,"Failed to load movie details"),o(),t(5,"p",40),n(6,"Please try again later."),o(),t(7,"button",41),v("click",function(){_(e);let m=p();return C(m.loadMovieDetails())}),n(8," Retry "),o()()}}var P=class l{movieService=D(A);movieSubscription;imdbID=k.required();onClose=y();isFavorite=k.required();onToggleFavorite=y();movie=h(null);isLoading=h(!0);ngOnInit(){this.loadMovieDetails()}ngOnDestroy(){this.movieSubscription?.unsubscribe()}loadMovieDetails(){let i=this.imdbID();i&&(this.isLoading.set(!0),this.movieSubscription?.unsubscribe(),this.movieSubscription=this.movieService.getMovieDetails(i).subscribe({next:e=>{this.movie.set(e),this.isLoading.set(!1)},error:e=>{console.error("Error fetching movie details:",e),this.movie.set(null),this.isLoading.set(!1)}}))}getImageSource(){let i=this.movie(),e=i?.poster,r=i?.title||"No Poster";return!e||this.isInvalidUrl(e)||this.isBrokenUrl(e)?this.movieService.createFallbackImage(r):e}onImageError(i){let e=i.target;if(e.src.startsWith("data:image"))return;let r=this.movie()?.title||"No Poster";this.movieService.addBrokenUrl(e.src),e.src=this.movieService.createFallbackImage(r)}isInvalidUrl(i){return i==="N/A"||i==="null"||i==="undefined"||!i.startsWith("http")||i.includes("localhost:4200/N/A")}isBrokenUrl(i){return this.movieService.brokenUrlPatterns?.some(r=>i.includes(r))||!1}exportToCSV(){let i=this.movie();if(!i)return;let e=["ID","Title","Year","Genre","Director","Actors","Plot","IMDb Rating"],r=[i.id,`"${i.title?.replace(/"/g,'""')}"`,i.year,i.genre||"N/A",i.director||"N/A",i.actors||"N/A",i.plot?`"${i.plot.replace(/"/g,'""')}"`:"N/A",i.imdbRating||"N/A"],m=[e.join(","),r.join(",")].join(`
`),x=new Blob(["\uFEFF"+m],{type:"text/csv;charset=utf-8;"}),w=URL.createObjectURL(x),b=document.createElement("a");b.href=w,b.download=`${i.title?.replace(/[^a-z0-9]/gi,"_")}_details.csv`||"movie_details.csv",b.click(),URL.revokeObjectURL(w)}close(){this.onClose.emit()}toggleFavorite(){this.onToggleFavorite.emit()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=I({type:l,selectors:[["app-movie-details"]],inputs:{imdbID:[1,"imdbID"],isFavorite:[1,"isFavorite"]},outputs:{onClose:"onClose",onToggleFavorite:"onToggleFavorite"},decls:18,vars:12,consts:[[1,"fixed","inset-0","bg-black","bg-opacity-70","flex","items-center","justify-center","p-4","z-50",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","max-w-4xl","w-full","max-h-[90vh]","flex","flex-col","movie-details-content",3,"click"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200","bg-gray-50","flex-shrink-0"],[1,"p-2","rounded-lg","hover:bg-gray-200","transition-all","duration-200","ease-in-out","hover:scale-110","text-gray-600","close-button",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","gap-3","items-center"],[1,"p-2","rounded-lg","transition-all","duration-200","ease-in-out","hover:scale-110","favorite-button",3,"click"],["fill","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],[1,"flex","items-center","gap-2","bg-blue-500","text-white","px-4","py-2","rounded-lg","hover:bg-blue-600","transition-all","duration-200","ease-in-out","hover:-translate-y-px","export-button",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"flex-1","overflow-y-auto"],[1,"flex","flex-col","items-center","justify-center","p-12","min-h-48"],[1,"p-6"],[1,"flex","flex-col","items-center","justify-center","p-12","text-center"],[1,"w-10","h-10","border-4","border-gray-200","border-t-blue-500","rounded-full","animate-spin","mb-4"],[1,"text-gray-500","text-lg"],[1,"flex","flex-col","sm:flex-row","gap-6","mb-8"],[1,"flex-shrink-0"],[1,"w-48","h-72","object-cover","rounded-lg","shadow-md","transition-transform","duration-200","ease-in-out","hover:scale-102","movie-poster",3,"error","src","alt"],[1,"flex-1","min-w-0","movie-details-info"],[1,"text-2xl","sm:text-3xl","font-bold","text-gray-900","mb-2","leading-tight"],[1,"flex","flex-wrap","gap-4","mb-3","text-sm","text-gray-600"],[1,"font-medium"],[1,"flex","items-center","gap-1"],[1,"text-gray-700","mb-4"],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","text-sm"],[1,"flex","flex-col","gap-1"],[1,"font-semibold","text-gray-900"],[1,"text-gray-700"],[1,"text-lg","font-semibold","text-gray-900","mb-3"],[1,"text-gray-700","leading-relaxed","mb-2"],[1,"flex","flex-wrap","gap-2"],[1,"bg-blue-100","text-blue-800","px-3","py-1","rounded-full","text-sm","font-medium"],[1,"bg-green-100","text-green-800","px-3","py-1","rounded-full","text-sm","font-medium"],[1,"bg-yellow-100","text-yellow-800","px-3","py-1","rounded-full","text-sm","font-medium"],[1,"text-4xl","mb-4"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"bg-blue-500","text-white","px-6","py-2","rounded-lg","hover:bg-blue-600","transition-colors",3,"click"]],template:function(e,r){e&1&&(t(0,"div",0),v("click",function(){return r.close()}),t(1,"div",1),v("click",function(x){return x.stopPropagation()}),t(2,"div",2)(3,"button",3),v("click",function(){return r.close()}),E(),t(4,"svg",4),u(5,"path",5),o()(),f(),t(6,"div",6)(7,"button",7),v("click",function(){return r.toggleFavorite()}),E(),t(8,"svg",8),u(9,"path"),o()(),f(),t(10,"button",9),v("click",function(){return r.exportToCSV()}),E(),t(11,"svg",10),u(12,"path",11),o(),n(13," Export CSV "),o()()(),f(),t(14,"div",12),s(15,V,4,0,"div",13),s(16,R,54,15,"div",14),s(17,z,9,0,"div",15),o()()()),e&2&&(a(7),N("text-red-500",r.isFavorite())("text-gray-400",!r.isFavorite())("hover:bg-red-50",r.isFavorite())("hover:bg-gray-100",!r.isFavorite()),a(2),L("d",(r.isFavorite(),"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z")),a(6),c(r.isLoading()?15:-1),a(),c(!r.isLoading()&&r.movie()?16:-1),a(),c(!r.isLoading()&&!r.movie()?17:-1))},dependencies:[F],encapsulation:2})};export{P as a};
